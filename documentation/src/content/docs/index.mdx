---
title: Parseff
description: Write parsers as plain functions. Algebraic effects handle the rest.
template: splash
hero:
  tagline: Write parsers as plain functions. Algebraic effects handle the rest.
  actions:
    - text: Quick Start
      link: /parseff/quick-start
      icon: right-arrow
      variant: primary
    - text: View on GitHub
      link: https://github.com/davesnx/parseff
      icon: external
    - text: View on opam
      link: https://opam.ocaml.org/packages/parseff
      icon: external
---

import { Card, CardGrid } from '@astrojs/starlight/components';

## What is Parseff?

Parseff is a parser combinator library for OCaml 5 where parsers are regular functions (`unit -> 'a`). No monadic operators (`>>=`, `>>|`, `*>`), no binding operators (`let*`, `let+`, `and+`). Algebraic effects handle backtracking, error reporting, and input management behind the scenes.

```ocaml
let ip_address () =
  let a = number () in
  let _ = Parseff.char '.' in
  let b = number () in
  let _ = Parseff.char '.' in
  let c = number () in
  let _ = Parseff.char '.' in
  let d = number () in
  Parseff.end_of_input ();
  (a, b, c, d)
```

Just `let` bindings and `;`. The parser reads like the format it parses.

<CardGrid>
  <Card title="Direct-style API" icon="pencil">
    Write `let x = consume "hello"` instead of `consume "hello" >>= fun x ->`. Parsers compose through ordinary function calls and sequencing.
  </Card>
  <Card title="Backtracking by default" icon="random">
    Alternation backtracks automatically. `or_` saves the cursor, tries the left branch, and restores on failure. No `try` combinator needed.
  </Card>
  <Card title="Typed errors" icon="warning">
    Return domain-specific errors via polymorphic variants or custom types. Pattern match on `Out_of_range`, `Invalid_format`, or whatever your domain needs.
  </Card>
  <Card title="Built for performance" icon="rocket">
    1.6x to 4.3x faster than Angstrom on JSON benchmarks, with 3x less memory. Zero-copy spans and fused operations for hot paths.
  </Card>
</CardGrid>

## Installation

```bash
opam install parseff
```

Requires OCaml >= 5.3. Then add it to your dune file:

```lisp
(executable
 (name my_parser)
 (libraries parseff))
```

## Features

- **Direct-style parsers** -- write parsers with `let` bindings and function calls, no monadic plumbing
- **Automatic backtracking** with `or_` and `one_of`
- **Typed domain errors** via polymorphic variants -- raise with `Parseff.error`, pattern match on the result
- **Streaming input** with `Source.of_string`, `Source.of_channel`, `Source.of_function` -- same parser code works with both `parse` and `parse_source`
- **Zero-copy spans** (`take_while_span`, `sep_by_take_span`) for low-allocation parsing on hot paths
- **Fused operations** (`sep_by_take`, `skip_while_then_char`, `fused_sep_take`) that reduce effect dispatches
- **Recursion depth limiting** with `rec_` and `~max_depth` to prevent stack overflows on malicious input
- **Minimal dependencies** -- only `re` for regex support

## Performance

1.6x to 4.3x faster than Angstrom on JSON benchmarks, with 3x less memory. See [Comparison with Angstrom](/parseff/guides/comparison) for methodology, benchmarks, API comparison, and a migration guide.

## References

- Krishnaswami & Yallop (PLDI '19) -- [A Typed, Algebraic Approach to Parsing](https://www.cl.cam.ac.uk/~jdy22/papers/a-typed-algebraic-approach-to-parsing.pdf)
- Kiselyov, O. et al. -- [Algebraic Effects and Effect Handlers](https://okmij.org/ftp/Computation/variables-effects.html)
- Inspired by [yieldparser](https://github.com/JavaScriptRegenerated/yieldparser) and [Angstrom](https://github.com/inhabitedtype/angstrom)
